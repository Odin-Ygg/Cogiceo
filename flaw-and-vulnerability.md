# Flaw and vulnerability

## http://vile.corp

**1. Flaw Identified:**

During my penetration test, I uncovered a significant security oversight. By conducting a file enumeration, I stumbled upon a directory named "\_dev". Accessible at [http://vile.corp/\_dev](http://vile.corp/\_dev), this directory turned out to be a prior version of [http://frontoffice.vile.corp](http://frontoffice.vile.corp). This development version granted me a much more detailed insight into the site than what was visible through the front office.

Moreover, within this "\_dev" directory, I managed to gain unhindered access to a .git folder. Utilizing the enumeration tool, dirbuster, I was able to compile a list of exposed files. This list divulged extremely sensitive information, including database passwords and user login credentials. The accessible git commits also provided me with a comprehensive view of the development history, potentially revealing other vulnerabilities.

**2. Solutions:**

In light of these vulnerabilities, here are the corrective actions I recommend:

* **Access Restriction:** It's imperative to ensure the "\_dev" directory is shielded from the public. Implementing robust authentication mechanisms, or better yet, moving this directory to a completely isolated environment, would be prudent.
* **Git Repository Cleanup:** I strongly advise removing the .git directory from the production server. Typically, git repositories shouldn't reside on production servers due to the inherent risks associated with their content.
* **Credential Reset:** Given the potential leak of usernames and passwords, a comprehensive reset of these credentials would be wise. It would also be prudent to inform all affected parties of this breach so they can take necessary precautions.



## http://frontoffice.vile.corp

Nothing found



## http://backoffice.vile.corp

**1. Flaws Identified:**

During my penetration testing, I identified multiple alarming security vulnerabilities on the domain `vile.corp`.

Firstly, while uploading a CV via [http://frontoffice.vile.corp](http://frontoffice.vile.corp) and subsequently accessing the "Candidate" tab on [http://backoffice.vile.corp](http://backoffice.vile.corp), I noticed that the "Name" and "Firstname" fields were vulnerable to Server-Side Template Injection (SSTI). This vulnerability enabled me to execute arbitrary commands, granting me a preview of the underlying system functionalities.

Furthermore, while navigating the `/home` directory on the machine, I discovered a user named "trooper". Delving into this user's directory, I came across `id_rsa` and `id_rsa.pub` files, which were readable. What's even more concerning is that I was accessing these files as the "www-data" user, which means they were improperly set with lax permissions. These files should only have been accessible to the "trooper" user.

Lastly, upon retrieving the `id_rsa` private key, I was able to establish an SSH connection without any issues since the key lacked a passphrase. This means that the system is at risk of unauthorized remote access.

**2. Solutions:**

Given the severity of these vulnerabilities, here are my recommended remedial actions:

* **SSTI Mitigation:** Review and sanitize all input fields on the backoffice platform to prevent malicious code or commands from being executed. It's essential to implement proper input validation and avoid using user input directly within templates.
* **Permission Review:** Conduct an extensive permission audit on the server. Specifically, the `id_rsa` and `id_rsa.pub` files within the "trooper" directory should be restricted to be only readable by the "trooper" user. It's also a good practice to review and correct any other misconfigured permissions.
* **SSH Key Security:** All SSH private keys (`id_rsa`) should have a strong passphrase to prevent unauthorized access. Educate users about the importance of key security and possibly implement regular key rotation.
* **User Education:** Engage in regular security awareness training, emphasizing the importance of setting strong permissions, using secure methods for file handling, and the risks associated with not following best practices.
